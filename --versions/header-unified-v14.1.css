/* ===== A83 HEADER + OFF-CANVAS — Unified v14.1 ===== */

/* --- Vars --------------------------------------------------- */
:root{
  --h-brand-1: var(--hcl-brand-1,#fff);  /* quasi weiß */
  --gl1: var(--hcl-ruby-11,#ff4d6d);
  --gl2: var(--hcl-glitch-9,#66ddff);

  --ease: cubic-bezier(.2,.8,.2,1);
  --t-burger: 280ms;           /* schneller */
  --t-card:   680ms;
  --t-card-out: 420ms;
  --t-backdrop-out: 320ms;
  --t-close-gap: 60ms;

  --brand: var(--hcl-ruby-9,#e54666);
  --card-bg: color-mix(in oklab,var(--brand) 12%, rgba(12,16,14,.82));
  --card-bd: color-mix(in oklab,var(--brand) 32%, rgba(229,70,102,.28));
  --dim: rgba(10,14,12,.55);
  --radius: 20px;
  --shadow: 0 12px 40px rgba(0,0,0,.35);

  --header-h: 52px;
}

/* --- Tone steuert Header-Farben ----------------------------- */
html{ --header-fg: var(--h-brand-1); --header-dim: color-mix(in oklab, var(--h-brand-1) 45%, transparent); }
html[data-header-tone="dark"]{  --header-fg: var(--h-brand-1); --header-dim: color-mix(in oklab, var(--h-brand-1) 40%, transparent); }
html[data-header-tone="light"]{ --header-fg: #0b0d0c;          --header-dim: color-mix(in oklab, #0b0d0c 60%, transparent); }

.site-header{ position:relative; z-index:40; }

/* ============================================================
   WORDMARK ( #brand-wordmark > a.wm-link )
   ============================================================ */
#brand-wordmark{ contain: paint; }
#brand-wordmark .wm-link{
  position:relative; display:inline-block;
  color: var(--header-fg);
  text-decoration:none; font-weight:600; letter-spacing:.02em; line-height:1;
  transition: color .2s ease, opacity .2s ease, filter .2s ease, transform .2s ease;
  will-change: transform, filter;
}
#brand-wordmark[data-wm="dim"] .wm-link{ color: var(--header-dim); }
#brand-wordmark[data-wm="lit"] .wm-link{ color: var(--header-fg); }

/* kurzer RGB-Glitch */
#brand-wordmark .wm-link.wm-burst{
  text-shadow: 1px 0 0 var(--gl1), -1px 0 0 var(--gl2), 0 0 6px color-mix(in oklab,var(--header-fg) 30%, transparent);
  animation: wm-jitter 280ms steps(16);
  filter: saturate(1.04);
}
@keyframes wm-jitter{
  0%,100%{ transform: translateX(0) skewX(0); }
  25%{ transform: translateX(.6px) skewX(.2deg); }
  50%{ transform: translateX(-.6px) skewX(-.2deg); }
  75%{ transform: translateX(.4px) skewX(.15deg); }
}

/* ============================================================
   CUSTOM BURGER (#nav-trigger.nav-toggle)
   ============================================================ */
#nav-trigger.nav-toggle{
  position:relative; display:inline-grid; place-items:center;
  width: clamp(38px, 6.2vw, 44px); height: clamp(30px, 5.2vw, 36px);
  border:0; background:transparent !important; box-shadow:none !important;
  color: var(--header-dim); cursor:pointer; user-select:none; border-radius:10px;
  transition: color .2s ease, transform .18s ease;
  isolation:isolate;
}
/* Alles was Dancepad evtl. rendert ausblenden, damit nix doppelt ist */
#nav-trigger.nav-toggle > *{ opacity:0 !important; }

#nav-trigger.nav-toggle::before{
  content:""; position:relative; width:22px; height:2px; border-radius:2px;
  background: currentColor; box-shadow: 0 -7px 0 currentColor, 0 7px 0 currentColor;
  transition: transform .16s ease, background-color .2s ease, box-shadow .2s ease;
}
#nav-trigger.nav-toggle:hover{ color: var(--header-fg); }
#nav-trigger.nav-toggle.is-open{ color: var(--header-fg); }
#nav-trigger.nav-toggle.is-anim::before{ transform: scaleX(1.06); }
#nav-trigger.nav-toggle.is-recoiling::before{ transform: translateY(0) scaleX(.94); }
#nav-trigger.nav-toggle.burst::before{
  animation: burger-jitter 260ms steps(14);
  filter: drop-shadow(1px 0 0 var(--gl1)) drop-shadow(-1px 0 0 var(--gl2));
}
@keyframes burger-jitter{
  0%,100%{ transform: translateX(0) }
  25%{ transform: translateX(.7px) }
  50%{ transform: translateX(-.7px) }
  75%{ transform: translateX(.4px) }
}

/* ============================================================
   OFF-CANVAS OVERLAY / CARD
   ============================================================ */
#nav-overlay{
  position: fixed; inset: 0; z-index: 1000;
  display:block !important; place-items: initial !important; align-items: initial !important; justify-content: initial !important; /* Anti-Center */
  pointer-events:none; opacity:0; isolation:isolate;
}
#nav-overlay[aria-hidden="false"]{ pointer-events:auto; opacity:1; }

#nav-overlay::before{
  content:""; position: fixed; inset:0; z-index:0; background: var(--dim);
  -webkit-backdrop-filter:none; backdrop-filter:none; opacity:0; transition:opacity var(--t-backdrop-out) var(--ease);
}
html[data-nav-state="opening"] #nav-overlay::before,
html[data-nav-state="open"]    #nav-overlay::before{
  opacity:1; -webkit-backdrop-filter: blur(14px) saturate(140%); backdrop-filter: blur(14px) saturate(140%);
}
html[data-nav-state="closing"] #nav-overlay::before{ transition-delay: calc(var(--t-card-out) + var(--t-close-gap)); opacity:0; }

/* Karte oben rechts (nie mittig) */
#nav-overlay .nav-card{
  position: fixed !important;
  top: max(var(--header-h, 52px), clamp(12px, 2vw, 24px)) !important;
  right: clamp(12px, 2vw, 24px) !important;
  left: auto !important; bottom: auto !important; margin:0 !important;
  width: min(560px, 92vw); max-height: calc(100vh - 24px);
  overflow:auto; border:1px solid var(--card-bd); border-radius: var(--radius);
  background: var(--card-bg); -webkit-backdrop-filter: saturate(120%); backdrop-filter: saturate(120%);
  box-shadow: var(--shadow); z-index:2; will-change: transform, opacity, filter;

  --from-x: 8px; --from-y: -6px; --from-scale: .94;
  opacity:0; transform: translate(var(--from-x), var(--from-y)) scale(var(--from-scale));
  filter: blur(6px);
  transition:
    transform var(--t-card) var(--ease) var(--t-burger),
    opacity   var(--t-card) var(--ease) var(--t-burger),
    filter    var(--t-card) var(--ease) var(--t-burger);
}
#nav-overlay .nav-card.card-primed{ transition:none !important; }
html[data-nav-state="opening"] #nav-overlay .nav-card,
html[data-nav-state="open"]    #nav-overlay .nav-card{ opacity:1; transform:none; filter:none; }

html[data-nav-state="closing"] #nav-overlay .nav-card{
  transition-delay:0ms; transition-duration:var(--t-card-out); transition-timing-function: var(--ease);
  opacity:0; transform: translate(6px,-4px) scale(.965);
  filter: blur(4px) saturate(1.05); overflow:hidden;
}

/* --- WILD GLITCH PACK (Card + Slices + Links) --------------- */
#nav-overlay .nav-card.glitch,
#nav-overlay .nav-card.glitch-strong{ filter: saturate(1.22) contrast(1.07); }
#nav-overlay .nav-card.glitch::before,
#nav-overlay .nav-card.glitch::after,
#nav-overlay .nav-card.glitch-strong::before,
#nav-overlay .nav-card.glitch-strong::after{
  content:""; position:absolute; inset:-1px; border-radius:inherit; pointer-events:none; z-index:3;
}
#nav-overlay .nav-card.glitch::before,
#nav-overlay .nav-card.glitch-strong::before{
  background: repeating-linear-gradient(to bottom, rgba(255,255,255,.10) 0 1px, transparent 2px 4px),
              radial-gradient( circle at 20% 30%, rgba(255,255,255,.06), transparent 40%),
              radial-gradient( circle at 80% 70%, rgba(255,255,255,.06), transparent 40%);
  mix-blend-mode: screen; opacity:.47; animation: a83-scan-strong 640ms linear both;
}
@keyframes a83-scan-strong{ 0%{transform:translateY(-80%)}100%{transform:translateY(80%)} }

#nav-overlay .nav-card.glitch::after{
  box-shadow: 2px 0 0 rgba(0,255,255,.52) inset, -2px 0 0 rgba(255,0,128,.45) inset,
              0 0 0 1px color-mix(in oklab,var(--brand) 70%, transparent) inset;
  opacity:.95; animation: a83-edge-jitter 480ms steps(16) both;
}
#nav-overlay .nav-card.glitch-strong::after{
  box-shadow: 3px 0 0 rgba(0,255,255,.6) inset, -3px 0 0 rgba(255,0,128,.55) inset,
              0 0 0 1px color-mix(in oklab,var(--brand) 80%, transparent) inset;
  opacity:1; animation: a83-edge-jitter-2 560ms steps(18) both;
}
@keyframes a83-edge-jitter{ 0%,100%{transform:translateX(0)}20%{transform:translateX(2px)}40%{transform:translateX(-2px)}60%{transform:translateX(2px)}80%{transform:translateX(-2px)} }
@keyframes a83-edge-jitter-2{0%,100%{transform:translateX(0) skewX(0)}25%{transform:translateX(3px) skewX(.5deg)}50%{transform:translateX(-3px) skewX(-.5deg)}75%{transform:translateX(3px) skewX(.5deg)}}

#nav-overlay .gl-slices{ position:absolute; inset:0; border-radius:inherit; pointer-events:none; z-index:4; }
#nav-overlay .gl-slice{
  position:absolute; left:-8px; right:-8px;
  background: linear-gradient(90deg, rgba(0,255,255,.20), rgba(255,0,128,.18) 40%, rgba(255,255,255,.08) 60%, rgba(0,0,0,0));
  mix-blend-mode: screen; filter: saturate(1.25) contrast(1.05);
  will-change: transform;
}
@keyframes a83-slice-shift{ 0%{transform:translateX(0)}25%{transform:translateX(6px)}50%{transform:translateX(-8px)}75%{transform:translateX(4px)}100%{transform:translateX(0)} }
@keyframes a83-slice-skew{  0%{transform:translateX(0) skewX(0)}20%{transform:translateX(-6px) skewX(-.6deg)}50%{transform:translateX(5px) skewX(.6deg)}80%{transform:translateX(-3px) skewX(-.4deg)}100%{transform:translateX(0) skewX(0)} }

/* Menü + Stagger */
#nav-overlay .nav-menu{ padding:12px 16px 18px; display:grid; gap:10px; }
#nav-overlay .nav-menu > a,
#nav-overlay .nav-menu > .nav-link{
  text-decoration:none; color:#fff; font-size:clamp(18px,2.4vw,22px); line-height:1.25;
  opacity:0; transform: translateY(6px); filter:blur(2px);
  transition: opacity .42s var(--ease), transform .42s var(--ease), filter .42s var(--ease);
}
html[data-nav-state="open"] #nav-overlay .nav-menu > *{ opacity:1; transform:none; filter:none; }
html[data-nav-state="open"] #nav-overlay .nav-menu > *:nth-child(1){ transition-delay:.24s }
html[data-nav-state="open"] #nav-overlay .nav-menu > *:nth-child(2){ transition-delay:.32s }
html[data-nav-state="open"] #nav-overlay .nav-menu > *:nth-child(3){ transition-delay:.40s }
html[data-nav-state="open"] #nav-overlay .nav-menu > *:nth-child(4){ transition-delay:.48s }
html[data-nav-state="open"] #nav-overlay .nav-menu > *:nth-child(5){ transition-delay:.56s }
html[data-nav-state="open"] #nav-overlay .nav-menu > *:nth-child(6){ transition-delay:.64s }

/* Link-Glitch-Bursts (nach Stagger, via JS .g1/.g2/.g3) */
#nav-overlay .nav-menu .g1,
#nav-overlay .nav-menu .g2,
#nav-overlay .nav-menu .g3{
  text-shadow: 1px 0 0 #0ff, -1px 0 0 #f0f, 0 0 10px rgba(255,255,255,.18);
  animation: a83-link-flicker 280ms steps(12) 2;
  filter: saturate(1.25) contrast(1.05);
}
@keyframes a83-link-flicker{ 0%{opacity:1}40%{opacity:.6}55%{opacity:1}70%{opacity:.7}100%{opacity:1} }

/* Smooth Close: */
html[data-nav-state="closing"] #nav-overlay .nav-menu > *{
  transition: opacity .24s var(--ease), transform .24s var(--ease), filter .24s var(--ease);
  opacity:0; transform: translateY(4px); filter: blur(2px);
}

/* Hint (single-line) */
#nav-overlay .nav-hint{
  position: fixed; left: clamp(12px,2vw,24px); bottom: clamp(12px,2vh,24px);
  display:inline-grid; grid-auto-flow:column; grid-template-columns:auto minmax(0,1fr);
  align-items:baseline; column-gap:0; width:max-content; max-width:calc(100vw - 32px);
  overflow:hidden; text-overflow:ellipsis; pointer-events:none; z-index:3;
  opacity:0; transition:opacity 220ms var(--ease);
  font-weight:800; letter-spacing:.08em; color:color-mix(in oklab,var(--brand) 80%, #fff);
  font-size:clamp(16px,2.0vw,20px);
}
#nav-overlay .nav-hint, #nav-overlay .nav-hint *{ white-space:nowrap; word-break:keep-all; overflow-wrap:normal; hyphens:none; }
#nav-overlay.hint-visible .nav-hint{ opacity:.95; }

/* Body-Lock */
html.nav-lock, html.nav-lock body{ overflow:hidden !important; touch-action:none; }
body.nav-fixed{ position:fixed; width:100%; left:0; right: var(--sbw, 0px); }

/* --- Brand Watermark (zentriert; Karte bleibt oben rechts) -- */
#nav-overlay .nav-card{ position:relative; overflow:hidden; }
#nav-overlay .nav-card #nav-brandmark{
  position:absolute; inset:0; z-index:0; pointer-events:none; opacity:.10; mix-blend-mode: screen;
  -webkit-mask: url('/cms/wp-content/uploads/2025/10/logo-a83-white.svg') no-repeat center / min(72%, 520px) auto;
          mask: url('/cms/wp-content/uploads/2025/10/logo-a83-white.svg') no-repeat center / min(72%, 520px) auto;
  background:
    radial-gradient(40% 40% at 50% 46%, rgba(255,255,255,.16), transparent 62%),
    conic-gradient(from 0deg, rgba(255,255,255,.08), transparent 70%);
  transform: translateZ(0);
  transition: opacity .45s var(--ease), transform .45s var(--ease), filter .45s var(--ease);
}
html[data-nav-state="opening"] #nav-overlay .nav-card #nav-brandmark{ opacity:.16; transform: scale(1.02); }
html[data-nav-state="closing"] #nav-overlay .nav-card #nav-brandmark{ opacity:0; transform: scale(.985); filter: blur(1px) saturate(1.05); }
#nav-overlay .nav-card > *:not(#nav-brandmark){ position:relative; z-index:1; }

/* --- Kill terminal icons everywhere ------------------------ */
#nav-overlay .nav-menu > a::before,
#nav-overlay .nav-menu > .nav-link::before{ content: none !important; }

/* Motion-Respect */
@media (prefers-reduced-motion: reduce){
  #brand-wordmark .wm-link.wm-burst,
  #nav-trigger.nav-toggle.burst,
  #nav-overlay .nav-card,
  #nav-overlay .nav-menu > *,
  #nav-overlay .nav-hint{ animation:none !important; transition:none !important; }
}